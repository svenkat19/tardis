

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>tardis.plasma.properties.continuum_processes &mdash; tardis v2021.7.12.0.dev3+g7d3899ed</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/plot_directive.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../../_static/tardis_logo.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link href="../../../../_static/tardis.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> tardis
          

          
          </a>

          
            
            
              <div class="version">
                2021.7.12.0.dev3+g7d3899ed
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quickstart/quickstart.html">Quickstart for TARDIS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Input/Output</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../io/configuration/index.html">Configuration (Required Input)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../io/optional/index.html">Optional Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../io/visualization/index.html">Visualization Tools &amp; Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../io/output/index.html">Additional Outputs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics Walkthrough</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../physics/setup/index.html">Setting Up the Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../physics/montecarlo/index.html">Monte Carlo Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../physics/est_and_conv/index.html">Estimators and Convergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../physics/spectrum/index.html">Spectrum Generation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Research with TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../research/index.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Team &amp; Credits</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../team_and_governance/index.html">Team and Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../credits.html">Credits &amp; Publication Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../sponsors.html">Sponsors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../CONTRIBUTING.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../development/index.html">Developer Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../CHANGELOG.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../roadmap.html">Development Roadmap</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/modules.html">tardis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../zreferences.html">TARDIS Papers and useful References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Outdated</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../outdated/index.html">Outdated Documentation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">tardis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
      <li>tardis.plasma.properties.continuum_processes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for tardis.plasma.properties.continuum_processes</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">prange</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">from</span> <span class="nn">tardis</span> <span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>

<span class="kn">from</span> <span class="nn">tardis.plasma.exceptions</span> <span class="kn">import</span> <span class="n">PlasmaException</span>
<span class="kn">from</span> <span class="nn">tardis.plasma.properties.base</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ProcessingPlasmaProperty</span><span class="p">,</span>
    <span class="n">Input</span><span class="p">,</span>
    <span class="n">TransitionProbabilitiesProperty</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">tardis.plasma.properties.j_blues</span> <span class="kn">import</span> <span class="n">JBluesDiluteBlackBody</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;SpontRecombRateCoeff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;StimRecombRateCoeff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PhotoIonRateCoeff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PhotoIonEstimatorsNormFactor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PhotoIonRateCoeffEstimator&quot;</span><span class="p">,</span>
    <span class="s2">&quot;StimRecombRateCoeffEstimator&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CorrPhotoIonRateCoeff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;BfHeatingRateCoeffEstimator&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SpontRecombCoolingRateCoeff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RawRecombTransProbs&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RawPhotoIonTransProbs&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CollDeexcRateCoeff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CollExcRateCoeff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RawCollisionTransProbs&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AdiabaticCoolingRate&quot;</span><span class="p">,</span>
    <span class="s2">&quot;FreeFreeCoolingRate&quot;</span><span class="p">,</span>
    <span class="s2">&quot;FreeBoundCoolingRate&quot;</span><span class="p">,</span>
    <span class="s2">&quot;BoundFreeOpacity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LevelNumberDensityLTE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PhotoIonBoltzmannFactor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;FreeBoundEmissionCDF&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RawTwoPhotonTransProbs&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TwoPhotonEmissionCDF&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CollIonRateCoeffSeaton&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CollRecombRateCoeff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RawCollIonTransProbs&quot;</span><span class="p">,</span>
<span class="p">]</span>


<span class="n">K_B</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">k_B</span><span class="o">.</span><span class="n">cgs</span><span class="o">.</span><span class="n">value</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">cgs</span><span class="o">.</span><span class="n">value</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">cgs</span><span class="o">.</span><span class="n">value</span>
<span class="n">A0</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">a0</span><span class="o">.</span><span class="n">cgs</span><span class="o">.</span><span class="n">value</span>
<span class="n">M_E</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">m_e</span><span class="o">.</span><span class="n">cgs</span><span class="o">.</span><span class="n">value</span>
<span class="n">BETA_COLL</span> <span class="o">=</span> <span class="p">(</span><span class="n">H</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">K_B</span> <span class="o">*</span> <span class="n">M_E</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">**</span> <span class="mi">3</span><span class="p">))</span> <span class="o">**</span> <span class="mf">0.5</span>


<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">njit_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;fastmath&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;parallel&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>


<span class="nd">@njit</span><span class="p">(</span><span class="o">**</span><span class="n">njit_dict</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">integrate_array_by_blocks</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">block_references</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Integrate a function over blocks.</span>

<span class="sd">    This function integrates a function `f` defined at locations `x`</span>
<span class="sd">    over blocks given in `block_references`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    f : numpy.ndarray, dtype float</span>
<span class="sd">        2D input array to integrate.</span>
<span class="sd">    x : numpy.ndarray, dtype float</span>
<span class="sd">        1D array with the sample points corresponding to the `f` values.</span>
<span class="sd">    block_references : numpy.ndarray, dtype int</span>
<span class="sd">        1D array with the start indices of the blocks to be integrated.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numpy.ndarray, dtype float</span>
<span class="sd">        2D array with integrated values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">integrated</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">block_references</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>  <span class="c1"># columns</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">integrated</span><span class="p">)):</span>  <span class="c1"># rows</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">block_references</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">block_references</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">integrated</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">integrated</span>


<span class="c1"># It is currently not possible to use scipy.integrate.cumulative_trapezoid in</span>
<span class="c1"># numba. So here is my own implementation.</span>
<span class="nd">@njit</span><span class="p">(</span><span class="o">**</span><span class="n">njit_dict</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">numba_cumulative_trapezoid</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cumulatively integrate f(x) using the composite trapezoidal rule.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    f : numpy.ndarray, dtype float</span>
<span class="sd">        Input array to integrate.</span>
<span class="sd">    x : numpy.ndarray, dtype float</span>
<span class="sd">        The coordinate to integrate along.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numpy.ndarray, dtype float</span>
<span class="sd">        The result of cumulative integration of f along x</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">integ</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">f</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">integ</span> <span class="o">/</span> <span class="n">integ</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


<span class="nd">@njit</span><span class="p">(</span><span class="o">**</span><span class="n">njit_dict</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">cumulative_integrate_array_by_blocks</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">block_references</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cumulatively integrate a function over blocks.</span>

<span class="sd">    This function cumulatively integrates a function `f` defined at</span>
<span class="sd">    locations `x` over blocks given in `block_references`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    f : numpy.ndarray, dtype float</span>
<span class="sd">        Input array to integrate. Shape is (N_freq, N_shells), where</span>
<span class="sd">        N_freq is the number of frequency values and N_shells is the number</span>
<span class="sd">        of computational shells.</span>
<span class="sd">    x : numpy.ndarray, dtype float</span>
<span class="sd">        The sample points corresponding to the `f` values. Shape is (N_freq,).</span>
<span class="sd">    block_references : numpy.ndarray, dtype int</span>
<span class="sd">        The start indices of the blocks to be integrated. Shape is (N_blocks,).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numpy.ndarray, dtype float</span>
<span class="sd">        Array with cumulatively integrated values. Shape is (N_freq, N_shells)</span>
<span class="sd">        same as f.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">block_references</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">integrated</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>  <span class="c1"># columns</span>
        <span class="c1"># TODO: Avoid this loop through vectorization of cumulative_trapezoid</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">n_rows</span><span class="p">):</span>  <span class="c1"># rows</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">block_references</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">block_references</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">integrated</span><span class="p">[</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">stop</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">numba_cumulative_trapezoid</span><span class="p">(</span>
                <span class="n">f</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">integrated</span>


<span class="k">def</span> <span class="nf">get_ion_multi_index</span><span class="p">(</span><span class="n">multi_index_full</span><span class="p">,</span> <span class="n">next_higher</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the corresponding ion MultiIndex for a level MultiIndex.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    multi_index_full : pandas.MultiIndex (atomic_number, ion_number,</span>
<span class="sd">                                          level_number)</span>
<span class="sd">    next_higher : bool, default True</span>
<span class="sd">        If True use ion number of next higher ion, else use ion_number from</span>
<span class="sd">        multi_index_full.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas.MultiIndex (atomic_number, ion_number)</span>
<span class="sd">       Ion MultiIndex for the given level MultiIndex.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">atomic_number</span> <span class="o">=</span> <span class="n">multi_index_full</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ion_number</span> <span class="o">=</span> <span class="n">multi_index_full</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">next_higher</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">ion_number</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span><span class="n">atomic_number</span><span class="p">,</span> <span class="n">ion_number</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">get_ground_state_multi_index</span><span class="p">(</span><span class="n">multi_index_full</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the ground-state MultiIndex for the next higher ion.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    multi_index_full : pandas.MultiIndex (atomic_number, ion_number,</span>
<span class="sd">                                          level_number)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas.MultiIndex (atomic_number, ion_number)</span>
<span class="sd">        Ground-state MultiIndex for the next higher ion.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">atomic_number</span> <span class="o">=</span> <span class="n">multi_index_full</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ion_number</span> <span class="o">=</span> <span class="n">multi_index_full</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">level_number</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">ion_number</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span><span class="n">atomic_number</span><span class="p">,</span> <span class="n">ion_number</span><span class="p">,</span> <span class="n">level_number</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">cooling_rate_series2dataframe</span><span class="p">(</span><span class="n">cooling_rate_series</span><span class="p">,</span> <span class="n">destination_level_idx</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transform cooling-rate Series to DataFrame.</span>

<span class="sd">    This function transforms a Series with cooling rates into</span>
<span class="sd">    an indexed DataFrame that can be used in MarkovChainTransProbs.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cooling_rate_series : pandas.Series, dtype float</span>
<span class="sd">        Cooling rates for a process with a single destination idx.</span>
<span class="sd">        Examples are adiabatic cooling or free-free cooling.</span>
<span class="sd">    destination_level_idx : str</span>
<span class="sd">        Destination idx of the cooling process; for example</span>
<span class="sd">        &#39;adiabatic&#39; for adiabatic cooling.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cooling_rate_frame : pandas.DataFrame, dtype float</span>
<span class="sd">        Indexed by source_level_idx, destination_level_idx, transition_type</span>
<span class="sd">        for the use in MarkovChainTransProbs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">index_names</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;source_level_idx&quot;</span><span class="p">,</span>
        <span class="s2">&quot;destination_level_idx&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transition_type&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span>
        <span class="p">[(</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">destination_level_idx</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">names</span><span class="o">=</span><span class="n">index_names</span>
    <span class="p">)</span>
    <span class="n">cooling_rate_frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">cooling_rate_series</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">cooling_rate_frame</span>


<span class="k">class</span> <span class="nc">IndexSetterMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">set_index</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">photo_ion_idx</span><span class="p">,</span> <span class="n">transition_type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">photo_ion_idx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
        <span class="n">transition_type</span> <span class="o">=</span> <span class="n">transition_type</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span>
            <span class="n">idx</span><span class="o">.</span><span class="n">destination_level_idx</span>
        <span class="p">)</span>
        <span class="n">transition_type</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">transition_type</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;transition_type&quot;</span><span class="p">)</span>
        <span class="n">idx_arrays</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span><span class="o">.</span><span class="n">source_level_idx</span><span class="p">,</span> <span class="n">idx</span><span class="o">.</span><span class="n">destination_level_idx</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">reverse</span><span class="p">:</span>
            <span class="n">idx_arrays</span> <span class="o">=</span> <span class="n">idx_arrays</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">idx_arrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition_type</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span><span class="n">idx_arrays</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reverse</span><span class="p">:</span>
            <span class="n">index</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p</span>


<div class="viewcode-block" id="SpontRecombRateCoeff"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.SpontRecombRateCoeff">[docs]</a><span class="k">class</span> <span class="nc">SpontRecombRateCoeff</span><span class="p">(</span><span class="n">ProcessingPlasmaProperty</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    alpha_sp : pandas.DataFrame, dtype float</span>
<span class="sd">        The rate coefficient for spontaneous recombination.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;alpha_sp&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\alpha^{\textrm</span><span class="si">{sp}</span><span class="s2">}&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="SpontRecombRateCoeff.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.SpontRecombRateCoeff.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">photo_ion_cross_sections</span><span class="p">,</span>
        <span class="n">t_electrons</span><span class="p">,</span>
        <span class="n">photo_ion_block_references</span><span class="p">,</span>
        <span class="n">photo_ion_index</span><span class="p">,</span>
        <span class="n">phi_ik</span><span class="p">,</span>
        <span class="n">boltzmann_factor_photo_ion</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">x_sect</span> <span class="o">=</span> <span class="n">photo_ion_cross_sections</span><span class="p">[</span><span class="s2">&quot;x_sect&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">nu</span> <span class="o">=</span> <span class="n">photo_ion_cross_sections</span><span class="p">[</span><span class="s2">&quot;nu&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="n">alpha_sp</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x_sect</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">C</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">alpha_sp</span> <span class="o">=</span> <span class="n">alpha_sp</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">alpha_sp</span> <span class="o">=</span> <span class="n">alpha_sp</span> <span class="o">*</span> <span class="n">boltzmann_factor_photo_ion</span>
        <span class="n">alpha_sp</span> <span class="o">=</span> <span class="n">integrate_array_by_blocks</span><span class="p">(</span>
            <span class="n">alpha_sp</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">photo_ion_block_references</span>
        <span class="p">)</span>
        <span class="n">alpha_sp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">alpha_sp</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">photo_ion_index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">alpha_sp</span> <span class="o">*</span> <span class="n">phi_ik</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">alpha_sp</span><span class="o">.</span><span class="n">index</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="SpontRecombCoolingRateCoeff"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.SpontRecombCoolingRateCoeff">[docs]</a><span class="k">class</span> <span class="nc">SpontRecombCoolingRateCoeff</span><span class="p">(</span><span class="n">ProcessingPlasmaProperty</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    c_fb_sp : pandas.DataFrame, dtype float</span>
<span class="sd">        The rate coefficient for cooling by</span>
<span class="sd">        spontaneous recombination.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;c_fb_sp&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;c^{\textrm</span><span class="si">{sp}</span><span class="s2">}_{\textrm</span><span class="si">{fb}</span><span class="s2">}&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="SpontRecombCoolingRateCoeff.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.SpontRecombCoolingRateCoeff.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">photo_ion_cross_sections</span><span class="p">,</span>
        <span class="n">t_electrons</span><span class="p">,</span>
        <span class="n">photo_ion_block_references</span><span class="p">,</span>
        <span class="n">photo_ion_index</span><span class="p">,</span>
        <span class="n">phi_ik</span><span class="p">,</span>
        <span class="n">nu_i</span><span class="p">,</span>
        <span class="n">boltzmann_factor_photo_ion</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">x_sect</span> <span class="o">=</span> <span class="n">photo_ion_cross_sections</span><span class="p">[</span><span class="s2">&quot;x_sect&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">nu</span> <span class="o">=</span> <span class="n">photo_ion_cross_sections</span><span class="p">[</span><span class="s2">&quot;nu&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">nu_i</span> <span class="o">/</span> <span class="n">photo_ion_cross_sections</span><span class="p">[</span><span class="s2">&quot;nu&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span>
        <span class="n">alpha_sp</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x_sect</span> <span class="o">*</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">/</span> <span class="n">C</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">H</span>
        <span class="n">alpha_sp</span> <span class="o">=</span> <span class="n">alpha_sp</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">alpha_sp</span> <span class="o">=</span> <span class="n">alpha_sp</span> <span class="o">*</span> <span class="n">boltzmann_factor_photo_ion</span>
        <span class="n">alpha_sp</span> <span class="o">=</span> <span class="n">integrate_array_by_blocks</span><span class="p">(</span>
            <span class="n">alpha_sp</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">photo_ion_block_references</span>
        <span class="p">)</span>
        <span class="n">alpha_sp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">alpha_sp</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">photo_ion_index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">alpha_sp</span> <span class="o">*</span> <span class="n">phi_ik</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">alpha_sp</span><span class="o">.</span><span class="n">index</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="FreeBoundEmissionCDF"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.FreeBoundEmissionCDF">[docs]</a><span class="k">class</span> <span class="nc">FreeBoundEmissionCDF</span><span class="p">(</span><span class="n">ProcessingPlasmaProperty</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    fb_emission_cdf : pandas.DataFrame, dtype float</span>
<span class="sd">        The cumulative distribution function (CDF) for the frequencies of</span>
<span class="sd">        energy packets emitted in free-bound transitions. The tabulated CDF</span>
<span class="sd">        is used to sample packet frequencies in the Monte Carlo simulation.</span>
<span class="sd">        We use the same CDF for free-bound emission from k- and i-packets</span>
<span class="sd">        (in contrast to ARTIS).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;fb_emission_cdf&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;P(\nu_{bf, emission}) \leq \nu)&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="FreeBoundEmissionCDF.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.FreeBoundEmissionCDF.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">photo_ion_cross_sections</span><span class="p">,</span>
        <span class="n">t_electrons</span><span class="p">,</span>
        <span class="n">photo_ion_block_references</span><span class="p">,</span>
        <span class="n">photo_ion_index</span><span class="p">,</span>
        <span class="n">nu_i</span><span class="p">,</span>
        <span class="n">boltzmann_factor_photo_ion</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">x_sect</span> <span class="o">=</span> <span class="n">photo_ion_cross_sections</span><span class="p">[</span><span class="s2">&quot;x_sect&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">nu</span> <span class="o">=</span> <span class="n">photo_ion_cross_sections</span><span class="p">[</span><span class="s2">&quot;nu&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="c1"># alpha_sp_E will be missing a lot of prefactors since we are only</span>
        <span class="c1"># interested in relative values here</span>
        <span class="n">alpha_sp_E</span> <span class="o">=</span> <span class="n">nu</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x_sect</span>
        <span class="n">alpha_sp_E</span> <span class="o">=</span> <span class="n">alpha_sp_E</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">alpha_sp_E</span> <span class="o">=</span> <span class="n">alpha_sp_E</span> <span class="o">*</span> <span class="n">boltzmann_factor_photo_ion</span>
        <span class="n">alpha_sp_E</span> <span class="o">=</span> <span class="n">cumulative_integrate_array_by_blocks</span><span class="p">(</span>
            <span class="n">alpha_sp_E</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">photo_ion_block_references</span>
        <span class="p">)</span>
        <span class="n">fb_emission_cdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">alpha_sp_E</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">photo_ion_cross_sections</span><span class="o">.</span><span class="n">index</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">fb_emission_cdf</span></div></div>


<div class="viewcode-block" id="PhotoIonRateCoeff"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.PhotoIonRateCoeff">[docs]</a><span class="k">class</span> <span class="nc">PhotoIonRateCoeff</span><span class="p">(</span><span class="n">ProcessingPlasmaProperty</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    gamma : pandas.DataFrame, dtype float</span>
<span class="sd">        The rate coefficient for radiative ionization.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;gamma&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\gamma&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="PhotoIonRateCoeff.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.PhotoIonRateCoeff.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">photo_ion_cross_sections</span><span class="p">,</span>
        <span class="n">gamma_estimator</span><span class="p">,</span>
        <span class="n">photo_ion_norm_factor</span><span class="p">,</span>
        <span class="n">photo_ion_block_references</span><span class="p">,</span>
        <span class="n">photo_ion_index</span><span class="p">,</span>
        <span class="n">t_rad</span><span class="p">,</span>
        <span class="n">w</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># Used for initialization</span>
        <span class="k">if</span> <span class="n">gamma_estimator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_from_dilute_bb</span><span class="p">(</span>
                <span class="n">photo_ion_cross_sections</span><span class="p">,</span>
                <span class="n">photo_ion_block_references</span><span class="p">,</span>
                <span class="n">photo_ion_index</span><span class="p">,</span>
                <span class="n">t_rad</span><span class="p">,</span>
                <span class="n">w</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma_estimator</span> <span class="o">*</span> <span class="n">photo_ion_norm_factor</span>
        <span class="k">return</span> <span class="n">gamma</span></div>

<div class="viewcode-block" id="PhotoIonRateCoeff.calculate_from_dilute_bb"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.PhotoIonRateCoeff.calculate_from_dilute_bb">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">calculate_from_dilute_bb</span><span class="p">(</span>
        <span class="n">photo_ion_cross_sections</span><span class="p">,</span>
        <span class="n">photo_ion_block_references</span><span class="p">,</span>
        <span class="n">photo_ion_index</span><span class="p">,</span>
        <span class="n">t_rad</span><span class="p">,</span>
        <span class="n">w</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">nu</span> <span class="o">=</span> <span class="n">photo_ion_cross_sections</span><span class="p">[</span><span class="s2">&quot;nu&quot;</span><span class="p">]</span>
        <span class="n">x_sect</span> <span class="o">=</span> <span class="n">photo_ion_cross_sections</span><span class="p">[</span><span class="s2">&quot;x_sect&quot;</span><span class="p">]</span>
        <span class="n">j_nus</span> <span class="o">=</span> <span class="n">JBluesDiluteBlackBody</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span>
            <span class="n">photo_ion_cross_sections</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">t_rad</span><span class="p">,</span> <span class="n">w</span>
        <span class="p">)</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="n">j_nus</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x_sect</span> <span class="o">/</span> <span class="n">nu</span> <span class="o">/</span> <span class="n">H</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="n">integrate_array_by_blocks</span><span class="p">(</span>
            <span class="n">gamma</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">nu</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">photo_ion_block_references</span>
        <span class="p">)</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">photo_ion_index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gamma</span></div></div>


<div class="viewcode-block" id="StimRecombRateCoeff"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.StimRecombRateCoeff">[docs]</a><span class="k">class</span> <span class="nc">StimRecombRateCoeff</span><span class="p">(</span><span class="n">ProcessingPlasmaProperty</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    alpha_stim : pandas.DataFrame, dtype float</span>
<span class="sd">        The rate coefficient for stimulated recombination.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;alpha_stim&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\alpha^{\textrm</span><span class="si">{stim}</span><span class="s2">}&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="StimRecombRateCoeff.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.StimRecombRateCoeff.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">photo_ion_cross_sections</span><span class="p">,</span>
        <span class="n">alpha_stim_estimator</span><span class="p">,</span>
        <span class="n">photo_ion_norm_factor</span><span class="p">,</span>
        <span class="n">photo_ion_block_references</span><span class="p">,</span>
        <span class="n">photo_ion_index</span><span class="p">,</span>
        <span class="n">t_rad</span><span class="p">,</span>
        <span class="n">w</span><span class="p">,</span>
        <span class="n">phi_ik</span><span class="p">,</span>
        <span class="n">t_electrons</span><span class="p">,</span>
        <span class="n">boltzmann_factor_photo_ion</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># Used for initialization</span>
        <span class="k">if</span> <span class="n">alpha_stim_estimator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">alpha_stim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_from_dilute_bb</span><span class="p">(</span>
                <span class="n">photo_ion_cross_sections</span><span class="p">,</span>
                <span class="n">photo_ion_block_references</span><span class="p">,</span>
                <span class="n">photo_ion_index</span><span class="p">,</span>
                <span class="n">t_rad</span><span class="p">,</span>
                <span class="n">w</span><span class="p">,</span>
                <span class="n">t_electrons</span><span class="p">,</span>
                <span class="n">boltzmann_factor_photo_ion</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">alpha_stim</span> <span class="o">*=</span> <span class="n">phi_ik</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">alpha_stim</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">alpha_stim</span> <span class="o">=</span> <span class="n">alpha_stim_estimator</span> <span class="o">*</span> <span class="n">photo_ion_norm_factor</span>
        <span class="k">return</span> <span class="n">alpha_stim</span></div>

<div class="viewcode-block" id="StimRecombRateCoeff.calculate_from_dilute_bb"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.StimRecombRateCoeff.calculate_from_dilute_bb">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">calculate_from_dilute_bb</span><span class="p">(</span>
        <span class="n">photo_ion_cross_sections</span><span class="p">,</span>
        <span class="n">photo_ion_block_references</span><span class="p">,</span>
        <span class="n">photo_ion_index</span><span class="p">,</span>
        <span class="n">t_rad</span><span class="p">,</span>
        <span class="n">w</span><span class="p">,</span>
        <span class="n">t_electrons</span><span class="p">,</span>
        <span class="n">boltzmann_factor_photo_ion</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">nu</span> <span class="o">=</span> <span class="n">photo_ion_cross_sections</span><span class="p">[</span><span class="s2">&quot;nu&quot;</span><span class="p">]</span>
        <span class="n">x_sect</span> <span class="o">=</span> <span class="n">photo_ion_cross_sections</span><span class="p">[</span><span class="s2">&quot;x_sect&quot;</span><span class="p">]</span>
        <span class="n">j_nus</span> <span class="o">=</span> <span class="n">JBluesDiluteBlackBody</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span>
            <span class="n">photo_ion_cross_sections</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">t_rad</span><span class="p">,</span> <span class="n">w</span>
        <span class="p">)</span>
        <span class="n">j_nus</span> <span class="o">*=</span> <span class="n">boltzmann_factor_photo_ion</span>
        <span class="n">alpha_stim</span> <span class="o">=</span> <span class="n">j_nus</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x_sect</span> <span class="o">/</span> <span class="n">nu</span> <span class="o">/</span> <span class="n">H</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">alpha_stim</span> <span class="o">=</span> <span class="n">integrate_array_by_blocks</span><span class="p">(</span>
            <span class="n">alpha_stim</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">nu</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">photo_ion_block_references</span>
        <span class="p">)</span>
        <span class="n">alpha_stim</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">alpha_stim</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">photo_ion_index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">alpha_stim</span></div></div>


<div class="viewcode-block" id="RawRecombTransProbs"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.RawRecombTransProbs">[docs]</a><span class="k">class</span> <span class="nc">RawRecombTransProbs</span><span class="p">(</span><span class="n">TransitionProbabilitiesProperty</span><span class="p">,</span> <span class="n">IndexSetterMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    p_recomb : pandas.DataFrame, dtype float</span>
<span class="sd">        The unnormalized transition probabilities for</span>
<span class="sd">        spontaneous recombination.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;p_recomb&quot;</span><span class="p">,)</span>
    <span class="n">transition_probabilities_outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;p_recomb&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;p^{\textrm</span><span class="si">{recomb}</span><span class="s2">}&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="RawRecombTransProbs.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.RawRecombTransProbs.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha_sp</span><span class="p">,</span> <span class="n">nu_i</span><span class="p">,</span> <span class="n">energy_i</span><span class="p">,</span> <span class="n">photo_ion_idx</span><span class="p">):</span>
        <span class="n">p_recomb_deactivation</span> <span class="o">=</span> <span class="n">alpha_sp</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">nu_i</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">H</span>
        <span class="n">p_recomb_deactivation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
            <span class="n">p_recomb_deactivation</span><span class="p">,</span> <span class="n">photo_ion_idx</span><span class="p">,</span> <span class="n">transition_type</span><span class="o">=-</span><span class="mi">1</span>
        <span class="p">)</span>

        <span class="n">p_recomb_internal</span> <span class="o">=</span> <span class="n">alpha_sp</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">energy_i</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">p_recomb_internal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
            <span class="n">p_recomb_internal</span><span class="p">,</span> <span class="n">photo_ion_idx</span><span class="p">,</span> <span class="n">transition_type</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>
        <span class="n">p_recomb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">p_recomb_deactivation</span><span class="p">,</span> <span class="n">p_recomb_internal</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">p_recomb</span></div></div>


<div class="viewcode-block" id="RawPhotoIonTransProbs"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.RawPhotoIonTransProbs">[docs]</a><span class="k">class</span> <span class="nc">RawPhotoIonTransProbs</span><span class="p">(</span><span class="n">TransitionProbabilitiesProperty</span><span class="p">,</span> <span class="n">IndexSetterMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    p_photo_ion : pandas.DataFrame, dtype float</span>
<span class="sd">        The unnormalized transition probabilities for</span>
<span class="sd">        radiative ionization.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;p_photo_ion&quot;</span><span class="p">,)</span>
    <span class="n">transition_probabilities_outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;p_photo_ion&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;p^{\textrm</span><span class="si">{photo_ion}</span><span class="s2">}&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="RawPhotoIonTransProbs.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.RawPhotoIonTransProbs.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gamma_corr</span><span class="p">,</span> <span class="n">energy_i</span><span class="p">,</span> <span class="n">photo_ion_idx</span><span class="p">):</span>
        <span class="n">p_photo_ion</span> <span class="o">=</span> <span class="n">gamma_corr</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">energy_i</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">p_photo_ion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">p_photo_ion</span><span class="p">,</span> <span class="n">photo_ion_idx</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p_photo_ion</span></div></div>


<div class="viewcode-block" id="CorrPhotoIonRateCoeff"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.CorrPhotoIonRateCoeff">[docs]</a><span class="k">class</span> <span class="nc">CorrPhotoIonRateCoeff</span><span class="p">(</span><span class="n">ProcessingPlasmaProperty</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    gamma_corr : pandas.DataFrame, dtype float</span>
<span class="sd">        The rate coefficient for radiative ionization corrected for</span>
<span class="sd">        stimulated recombination.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;gamma_corr&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\gamma_\mathrm</span><span class="si">{corr}</span><span class="s2">&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="CorrPhotoIonRateCoeff.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.CorrPhotoIonRateCoeff.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">gamma</span><span class="p">,</span>
        <span class="n">alpha_stim</span><span class="p">,</span>
        <span class="n">electron_densities</span><span class="p">,</span>
        <span class="n">ion_number_density</span><span class="p">,</span>
        <span class="n">level_number_density</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">n_k_index</span> <span class="o">=</span> <span class="n">get_ion_multi_index</span><span class="p">(</span><span class="n">alpha_stim</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="n">n_k</span> <span class="o">=</span> <span class="n">ion_number_density</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">n_k_index</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">n_i</span> <span class="o">=</span> <span class="n">level_number_density</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">alpha_stim</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">gamma_corr</span> <span class="o">=</span> <span class="n">gamma</span> <span class="o">-</span> <span class="n">alpha_stim</span> <span class="o">*</span> <span class="n">n_k</span> <span class="o">*</span> <span class="n">electron_densities</span> <span class="o">/</span> <span class="n">n_i</span>
        <span class="n">num_neg_elements</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma_corr</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">num_neg_elements</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PlasmaException</span><span class="p">(</span><span class="s2">&quot;Negative values in CorrPhotoIonRateCoeff.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gamma_corr</span></div></div>


<div class="viewcode-block" id="PhotoIonEstimatorsNormFactor"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.PhotoIonEstimatorsNormFactor">[docs]</a><span class="k">class</span> <span class="nc">PhotoIonEstimatorsNormFactor</span><span class="p">(</span><span class="n">ProcessingPlasmaProperty</span><span class="p">):</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;photo_ion_norm_factor&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\frac</span><span class="si">{1}</span><span class="s2">{t_\textrm{simulation volume h}}&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="PhotoIonEstimatorsNormFactor.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.PhotoIonEstimatorsNormFactor.calculate">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="n">time_simulation</span><span class="p">,</span> <span class="n">volume</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">time_simulation</span> <span class="o">*</span> <span class="n">volume</span> <span class="o">*</span> <span class="n">H</span><span class="p">)</span> <span class="o">**</span> <span class="o">-</span><span class="mi">1</span></div></div>


<div class="viewcode-block" id="PhotoIonRateCoeffEstimator"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.PhotoIonRateCoeffEstimator">[docs]</a><span class="k">class</span> <span class="nc">PhotoIonRateCoeffEstimator</span><span class="p">(</span><span class="n">Input</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    gamma_estimator : pandas.DataFrame, dtype float</span>
<span class="sd">        Unnormalized MC estimator for the rate coefficient for radiative</span>
<span class="sd">        ionization.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;gamma_estimator&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\gamma_\textrm</span><span class="si">{estim}</span><span class="s2">&quot;</span><span class="p">,)</span></div>


<div class="viewcode-block" id="StimRecombRateCoeffEstimator"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.StimRecombRateCoeffEstimator">[docs]</a><span class="k">class</span> <span class="nc">StimRecombRateCoeffEstimator</span><span class="p">(</span><span class="n">Input</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    alpha_stim_estimator : pandas.DataFrame, dtype float</span>
<span class="sd">        Unnormalized MC estimator for the rate coefficient for stimulated</span>
<span class="sd">        recombination.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;alpha_stim_estimator&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\alpha^{\textrm</span><span class="si">{stim}</span><span class="s2">}_\textrm</span><span class="si">{estim}</span><span class="s2">&quot;</span><span class="p">,)</span></div>


<div class="viewcode-block" id="BfHeatingRateCoeffEstimator"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.BfHeatingRateCoeffEstimator">[docs]</a><span class="k">class</span> <span class="nc">BfHeatingRateCoeffEstimator</span><span class="p">(</span><span class="n">Input</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    bf_heating_coeff_estimator : pandas.DataFrame, dtype float</span>
<span class="sd">        Unnormalized MC estimator for the rate</span>
<span class="sd">        coefficient for bound-free heating.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;bf_heating_coeff_estimator&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;h_\textrm</span><span class="si">{bf}</span><span class="s2">_\textrm</span><span class="si">{estim}</span><span class="s2">&quot;</span><span class="p">,)</span></div>


<div class="viewcode-block" id="CollExcRateCoeff"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.CollExcRateCoeff">[docs]</a><span class="k">class</span> <span class="nc">CollExcRateCoeff</span><span class="p">(</span><span class="n">ProcessingPlasmaProperty</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    coll_exc_coeff : pandas.DataFrame, dtype float</span>
<span class="sd">        Rate coefficient for collisional excitation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;coll_exc_coeff&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;c_</span><span class="si">{lu}</span><span class="s2">&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="CollExcRateCoeff.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.CollExcRateCoeff.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">yg_interp</span><span class="p">,</span> <span class="n">yg_index</span><span class="p">,</span> <span class="n">t_electrons</span><span class="p">,</span> <span class="n">delta_E_yg</span><span class="p">):</span>
        <span class="n">yg</span> <span class="o">=</span> <span class="n">yg_interp</span><span class="p">(</span><span class="n">t_electrons</span><span class="p">)</span>
        <span class="n">boltzmann_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
            <span class="o">-</span><span class="n">delta_E_yg</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="p">(</span><span class="n">t_electrons</span> <span class="o">*</span> <span class="n">K_B</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">q_ij</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">BETA_COLL</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t_electrons</span><span class="p">)</span> <span class="o">*</span> <span class="n">yg</span> <span class="o">*</span> <span class="n">boltzmann_factor</span>
        <span class="p">)</span>  <span class="c1"># see formula A2 in Przybilla, Butler 2004 - Apj 609, 1181</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">q_ij</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">yg_index</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CollDeexcRateCoeff"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.CollDeexcRateCoeff">[docs]</a><span class="k">class</span> <span class="nc">CollDeexcRateCoeff</span><span class="p">(</span><span class="n">ProcessingPlasmaProperty</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    coll_deexc_coeff : pandas.DataFrame, dtype float</span>
<span class="sd">        Rate coefficient for collisional deexcitation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;coll_deexc_coeff&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;c_</span><span class="si">{ul}</span><span class="s2">&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="CollDeexcRateCoeff.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.CollDeexcRateCoeff.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thermal_lte_level_boltzmann_factor</span><span class="p">,</span> <span class="n">coll_exc_coeff</span><span class="p">):</span>
        <span class="n">level_lower_index</span> <span class="o">=</span> <span class="n">coll_exc_coeff</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="s2">&quot;level_number_upper&quot;</span><span class="p">)</span>
        <span class="n">level_upper_index</span> <span class="o">=</span> <span class="n">coll_exc_coeff</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="s2">&quot;level_number_lower&quot;</span><span class="p">)</span>

        <span class="n">n_lower_prop</span> <span class="o">=</span> <span class="n">thermal_lte_level_boltzmann_factor</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="n">level_lower_index</span>
        <span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">n_upper_prop</span> <span class="o">=</span> <span class="n">thermal_lte_level_boltzmann_factor</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="n">level_upper_index</span>
        <span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="n">coll_deexc_coeff</span> <span class="o">=</span> <span class="n">coll_exc_coeff</span> <span class="o">*</span> <span class="n">n_lower_prop</span> <span class="o">/</span> <span class="n">n_upper_prop</span>
        <span class="k">return</span> <span class="n">coll_deexc_coeff</span></div></div>


<div class="viewcode-block" id="RawCollisionTransProbs"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.RawCollisionTransProbs">[docs]</a><span class="k">class</span> <span class="nc">RawCollisionTransProbs</span><span class="p">(</span><span class="n">TransitionProbabilitiesProperty</span><span class="p">,</span> <span class="n">IndexSetterMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    p_coll : pandas.DataFrame, dtype float</span>
<span class="sd">        The unnormalized transition probabilities for</span>
<span class="sd">        collisional excitation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;p_coll&quot;</span><span class="p">,)</span>
    <span class="n">transition_probabilities_outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;p_coll&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;p^{\textrm</span><span class="si">{coll}</span><span class="s2">}&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="RawCollisionTransProbs.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.RawCollisionTransProbs.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">coll_exc_coeff</span><span class="p">,</span>
        <span class="n">coll_deexc_coeff</span><span class="p">,</span>
        <span class="n">yg_idx</span><span class="p">,</span>
        <span class="n">electron_densities</span><span class="p">,</span>
        <span class="n">delta_E_yg</span><span class="p">,</span>
        <span class="n">atomic_data</span><span class="p">,</span>
        <span class="n">level_number_density</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">p_deexc_deactivation</span> <span class="o">=</span> <span class="p">(</span><span class="n">coll_deexc_coeff</span> <span class="o">*</span> <span class="n">electron_densities</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span>
            <span class="n">delta_E_yg</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>
        <span class="n">p_deexc_deactivation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
            <span class="n">p_deexc_deactivation</span><span class="p">,</span> <span class="n">yg_idx</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="n">p_deexc_deactivation</span> <span class="o">=</span> <span class="n">p_deexc_deactivation</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">index_dd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">(</span>
            <span class="p">[</span><span class="n">p_deexc_deactivation</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">yg_idx</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;transition_type&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">p_deexc_deactivation</span> <span class="o">=</span> <span class="n">p_deexc_deactivation</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">index_dd</span><span class="p">)</span>

        <span class="n">level_lower_index</span> <span class="o">=</span> <span class="n">coll_deexc_coeff</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span>
            <span class="s2">&quot;level_number_upper&quot;</span>
        <span class="p">)</span>
        <span class="n">energy_lower</span> <span class="o">=</span> <span class="n">atomic_data</span><span class="o">.</span><span class="n">levels</span><span class="o">.</span><span class="n">energy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">level_lower_index</span><span class="p">]</span>
        <span class="n">p_deexc_internal</span> <span class="o">=</span> <span class="p">(</span><span class="n">coll_deexc_coeff</span> <span class="o">*</span> <span class="n">electron_densities</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span>
            <span class="n">energy_lower</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>
        <span class="n">p_deexc_internal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
            <span class="n">p_deexc_internal</span><span class="p">,</span> <span class="n">yg_idx</span><span class="p">,</span> <span class="n">transition_type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="n">p_exc_internal</span> <span class="o">=</span> <span class="p">(</span><span class="n">coll_exc_coeff</span> <span class="o">*</span> <span class="n">electron_densities</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span>
            <span class="n">energy_lower</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>
        <span class="n">p_exc_internal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
            <span class="n">p_exc_internal</span><span class="p">,</span> <span class="n">yg_idx</span><span class="p">,</span> <span class="n">transition_type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="n">p_exc_cool</span> <span class="o">=</span> <span class="p">(</span><span class="n">coll_exc_coeff</span> <span class="o">*</span> <span class="n">electron_densities</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span>
            <span class="n">delta_E_yg</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>
        <span class="n">p_exc_cool</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">p_exc_cool</span> <span class="o">*</span> <span class="n">level_number_density</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">level_lower_index</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="p">)</span>
        <span class="n">p_exc_cool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">p_exc_cool</span><span class="p">,</span> <span class="n">yg_idx</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">p_exc_cool</span> <span class="o">=</span> <span class="n">p_exc_cool</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;destination_level_idx&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">exc_cool_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">(</span>
            <span class="p">[[</span><span class="s2">&quot;k&quot;</span><span class="p">],</span> <span class="n">p_exc_cool</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">yg_idx</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;transition_type&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">p_exc_cool</span> <span class="o">=</span> <span class="n">p_exc_cool</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">exc_cool_index</span><span class="p">)</span>
        <span class="n">p_coll</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
            <span class="p">[</span><span class="n">p_deexc_deactivation</span><span class="p">,</span> <span class="n">p_deexc_internal</span><span class="p">,</span> <span class="n">p_exc_internal</span><span class="p">,</span> <span class="n">p_exc_cool</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">p_coll</span></div></div>


<div class="viewcode-block" id="RawTwoPhotonTransProbs"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.RawTwoPhotonTransProbs">[docs]</a><span class="k">class</span> <span class="nc">RawTwoPhotonTransProbs</span><span class="p">(</span><span class="n">TransitionProbabilitiesProperty</span><span class="p">,</span> <span class="n">IndexSetterMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    p_two_photon : pandas.DataFrame, dtype float</span>
<span class="sd">        The unnormalized transition probabilities for two photon decay.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;p_two_photon&quot;</span><span class="p">,)</span>
    <span class="n">transition_probabilities_outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;p_two_photon&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="RawTwoPhotonTransProbs.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.RawTwoPhotonTransProbs.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">two_photon_data</span><span class="p">,</span> <span class="n">two_photon_idx</span><span class="p">,</span> <span class="n">density</span><span class="p">):</span>
        <span class="n">no_shells</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">density</span><span class="p">)</span>
        <span class="n">p_two_phot</span> <span class="o">=</span> <span class="n">two_photon_data</span><span class="o">.</span><span class="n">A_ul</span> <span class="o">*</span> <span class="n">two_photon_data</span><span class="o">.</span><span class="n">nu0</span> <span class="o">*</span> <span class="n">H</span>
        <span class="n">p_two_phot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">p_two_phot</span><span class="p">]</span> <span class="o">*</span> <span class="n">no_shells</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># TODO: In principle there could be internal two photon transitions</span>
        <span class="n">p_two_phot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
            <span class="n">p_two_phot</span><span class="p">,</span>
            <span class="n">two_photon_idx</span><span class="p">,</span>
            <span class="n">transition_type</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">p_two_phot</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">p_two_phot</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">set_levels</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;two-photon&quot;</span><span class="p">],</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;destination_level_idx&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">p_two_phot</span></div></div>


<div class="viewcode-block" id="TwoPhotonEmissionCDF"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.TwoPhotonEmissionCDF">[docs]</a><span class="k">class</span> <span class="nc">TwoPhotonEmissionCDF</span><span class="p">(</span><span class="n">ProcessingPlasmaProperty</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    two_photon_emission_cdf : pandas.DataFrame, dtype float</span>
<span class="sd">        The cumulative distribution function (CDF) for the frequencies of</span>
<span class="sd">        energy packets emitted in two photon transitions. The tabulated CDF</span>
<span class="sd">        is used to sample packet frequencies in the Monte Carlo simulation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;two_photon_emission_cdf&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="TwoPhotonEmissionCDF.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.TwoPhotonEmissionCDF.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">two_photon_data</span><span class="p">):</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="mi">500</span>
        <span class="c1"># The number of two photon transitions is very small</span>
        <span class="c1"># and the CDF has to be calculated only once.</span>
        <span class="c1"># There is no need to vectorize the calculation.</span>
        <span class="n">emission_cdfs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">two_photon_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">alpha</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">beta</span>
            <span class="n">gamma</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">gamma</span>
            <span class="n">nu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">nu0</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">nu</span> <span class="o">/</span> <span class="n">row</span><span class="o">.</span><span class="n">nu0</span>
            <span class="n">j_nu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_j_nu</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>

            <span class="n">cdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span>
            <span class="n">cdf</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">numba_cumulative_trapezoid</span><span class="p">(</span><span class="n">j_nu</span><span class="p">,</span> <span class="n">nu</span><span class="p">)</span>
            <span class="n">cdf</span> <span class="o">/=</span> <span class="n">cdf</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">index_cdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([</span><span class="n">index</span><span class="p">]</span> <span class="o">*</span> <span class="n">bins</span><span class="p">)</span>
            <span class="n">cdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;nu&quot;</span><span class="p">:</span> <span class="n">nu</span><span class="p">,</span> <span class="s2">&quot;cdf&quot;</span><span class="p">:</span> <span class="n">cdf</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">index_cdf</span><span class="p">)</span>
            <span class="n">emission_cdfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cdf</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">emission_cdfs</span><span class="p">)</span></div>

<div class="viewcode-block" id="TwoPhotonEmissionCDF.calculate_j_nu"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.TwoPhotonEmissionCDF.calculate_j_nu">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">calculate_j_nu</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate two photon emissivity.</span>

<span class="sd">        This function calculates the two photon emissivity in the frequency</span>
<span class="sd">        scale based on Eq. 2 and Eq. 3 in Nussbaumer &amp; Schmutz (1984). The</span>
<span class="sd">        emissivity is not normalized since it is only used to calculate</span>
<span class="sd">        relative emission probabilities.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        y : numpy.ndarray, dtype float</span>
<span class="sd">            Emission frequency divided by that of the normal line</span>
<span class="sd">            transition corresponding to the two photon decay.</span>
<span class="sd">        alpha : float</span>
<span class="sd">            Fit coefficient.</span>
<span class="sd">        beta : float</span>
<span class="sd">            Fit coefficient.</span>
<span class="sd">        gamma : float</span>
<span class="sd">            Fit coefficient.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy.ndarray, dtype float</span>
<span class="sd">            Unnormalized two photon emissivity in the frequency scale.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ay</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span> <span class="o">**</span> <span class="n">gamma</span><span class="p">)</span>
        <span class="n">ay</span> <span class="o">+=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span> <span class="o">**</span> <span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span> <span class="o">**</span> <span class="n">gamma</span>
        <span class="n">j_nu</span> <span class="o">=</span> <span class="n">ay</span> <span class="o">*</span> <span class="n">y</span>
        <span class="k">return</span> <span class="n">j_nu</span></div></div>


<div class="viewcode-block" id="AdiabaticCoolingRate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.AdiabaticCoolingRate">[docs]</a><span class="k">class</span> <span class="nc">AdiabaticCoolingRate</span><span class="p">(</span><span class="n">TransitionProbabilitiesProperty</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    cool_rate_adiabatic : pandas.DataFrame, dtype float</span>
<span class="sd">        The adiabatic cooling rate of the electron gas.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;cool_rate_adiabatic&quot;</span><span class="p">,)</span>
    <span class="n">transition_probabilities_outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;cool_rate_adiabatic&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;C_{\textrm</span><span class="si">{adiabatic}</span><span class="s2">}&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="AdiabaticCoolingRate.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.AdiabaticCoolingRate.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">electron_densities</span><span class="p">,</span> <span class="n">t_electrons</span><span class="p">,</span> <span class="n">time_explosion</span><span class="p">):</span>
        <span class="n">cool_rate_adiabatic</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">3.0</span> <span class="o">*</span> <span class="n">electron_densities</span> <span class="o">*</span> <span class="n">K_B</span> <span class="o">*</span> <span class="n">t_electrons</span>
        <span class="p">)</span> <span class="o">/</span> <span class="n">time_explosion</span>

        <span class="n">cool_rate_adiabatic</span> <span class="o">=</span> <span class="n">cooling_rate_series2dataframe</span><span class="p">(</span>
            <span class="n">cool_rate_adiabatic</span><span class="p">,</span> <span class="n">destination_level_idx</span><span class="o">=</span><span class="s2">&quot;adiabatic&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">cool_rate_adiabatic</span></div></div>


<div class="viewcode-block" id="FreeFreeCoolingRate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.FreeFreeCoolingRate">[docs]</a><span class="k">class</span> <span class="nc">FreeFreeCoolingRate</span><span class="p">(</span><span class="n">TransitionProbabilitiesProperty</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    cool_rate_ff : pandas.DataFrame, dtype float</span>
<span class="sd">        The free-free cooling rate of the electron gas.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;cool_rate_ff&quot;</span><span class="p">,)</span>
    <span class="n">transition_probabilities_outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;cool_rate_ff&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;C^{\textrm</span><span class="si">{ff}</span><span class="s2">}&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="FreeFreeCoolingRate.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.FreeFreeCoolingRate.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ion_number_density</span><span class="p">,</span> <span class="n">electron_densities</span><span class="p">,</span> <span class="n">t_electrons</span><span class="p">):</span>
        <span class="n">ff_cooling_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_ff_cooling_factor</span><span class="p">(</span>
            <span class="n">ion_number_density</span><span class="p">,</span> <span class="n">electron_densities</span>
        <span class="p">)</span>
        <span class="n">cool_rate_ff</span> <span class="o">=</span> <span class="mf">1.426e-27</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t_electrons</span><span class="p">)</span> <span class="o">*</span> <span class="n">ff_cooling_factor</span>
        <span class="n">cool_rate_ff</span> <span class="o">=</span> <span class="n">cooling_rate_series2dataframe</span><span class="p">(</span>
            <span class="n">cool_rate_ff</span><span class="p">,</span> <span class="n">destination_level_idx</span><span class="o">=</span><span class="s2">&quot;ff&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">cool_rate_ff</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_calculate_ff_cooling_factor</span><span class="p">(</span><span class="n">ion_number_density</span><span class="p">,</span> <span class="n">electron_densities</span><span class="p">):</span>
        <span class="n">ion_charge</span> <span class="o">=</span> <span class="n">ion_number_density</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">electron_densities</span>
            <span class="o">*</span> <span class="n">ion_number_density</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">ion_charge</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">factor</span></div>


<div class="viewcode-block" id="FreeBoundCoolingRate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.FreeBoundCoolingRate">[docs]</a><span class="k">class</span> <span class="nc">FreeBoundCoolingRate</span><span class="p">(</span><span class="n">TransitionProbabilitiesProperty</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    cool_rate_fb_total : pandas.DataFrame, dtype float</span>
<span class="sd">        The total free-bound cooling rate of the electron gas.</span>
<span class="sd">    cool_rate_fb : pandas.DataFrame, dtype float</span>
<span class="sd">        The individual free-bound cooling rates of the electron gas.</span>
<span class="sd">    p_fb_deactivation: pandas.DataFrame, dtype float</span>
<span class="sd">        Probabilities of free-bound cooling in a specific continuum</span>
<span class="sd">        (identified by its continuum_idx).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;cool_rate_fb_tot&quot;</span><span class="p">,</span> <span class="s2">&quot;cool_rate_fb&quot;</span><span class="p">,</span> <span class="s2">&quot;p_fb_deactivation&quot;</span><span class="p">)</span>
    <span class="n">transition_probabilities_outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;cool_rate_fb_tot&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;C^{\textrm{fb, tot}}&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;C^{\textrm</span><span class="si">{fb}</span><span class="s2">}&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="FreeBoundCoolingRate.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.FreeBoundCoolingRate.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">c_fb_sp</span><span class="p">,</span>
        <span class="n">electron_densities</span><span class="p">,</span>
        <span class="n">ion_number_density</span><span class="p">,</span>
        <span class="n">level2continuum_idx</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">next_ion_stage_index</span> <span class="o">=</span> <span class="n">get_ion_multi_index</span><span class="p">(</span><span class="n">c_fb_sp</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="n">n_k</span> <span class="o">=</span> <span class="n">ion_number_density</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">next_ion_stage_index</span><span class="p">]</span>

        <span class="n">cool_rate_fb</span> <span class="o">=</span> <span class="n">c_fb_sp</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">electron_densities</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">n_k</span><span class="o">.</span><span class="n">values</span>
        <span class="n">cool_rate_fb_tot</span> <span class="o">=</span> <span class="n">cooling_rate_series2dataframe</span><span class="p">(</span>
            <span class="n">cool_rate_fb</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;bf&quot;</span>
        <span class="p">)</span>

        <span class="n">p_fb_deactivation</span> <span class="o">=</span> <span class="n">cool_rate_fb</span> <span class="o">/</span> <span class="n">cool_rate_fb_tot</span><span class="o">.</span><span class="n">values</span>
        <span class="c1"># TODO: this will be needed more often; put it in a function</span>
        <span class="n">continuum_idx</span> <span class="o">=</span> <span class="n">level2continuum_idx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">p_fb_deactivation</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">p_fb_deactivation</span> <span class="o">=</span> <span class="n">p_fb_deactivation</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
            <span class="n">continuum_idx</span>
        <span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">p_fb_deactivation</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;continuum_idx&quot;</span>
        <span class="k">return</span> <span class="n">cool_rate_fb_tot</span><span class="p">,</span> <span class="n">cool_rate_fb</span><span class="p">,</span> <span class="n">p_fb_deactivation</span></div></div>


<div class="viewcode-block" id="BoundFreeOpacity"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.BoundFreeOpacity">[docs]</a><span class="k">class</span> <span class="nc">BoundFreeOpacity</span><span class="p">(</span><span class="n">ProcessingPlasmaProperty</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    chi_bf : pandas.DataFrame, dtype float</span>
<span class="sd">        Bound-free opacity corrected for stimulated emission.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;chi_bf&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\chi^{\textrm</span><span class="si">{bf}</span><span class="s2">}&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="BoundFreeOpacity.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.BoundFreeOpacity.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">photo_ion_cross_sections</span><span class="p">,</span>
        <span class="n">t_electrons</span><span class="p">,</span>
        <span class="n">phi_ik</span><span class="p">,</span>
        <span class="n">level_number_density</span><span class="p">,</span>
        <span class="n">lte_level_number_density</span><span class="p">,</span>
        <span class="n">boltzmann_factor_photo_ion</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">x_sect</span> <span class="o">=</span> <span class="n">photo_ion_cross_sections</span><span class="p">[</span><span class="s2">&quot;x_sect&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="n">n_i</span> <span class="o">=</span> <span class="n">level_number_density</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">photo_ion_cross_sections</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
        <span class="n">lte_n_i</span> <span class="o">=</span> <span class="n">lte_level_number_density</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">photo_ion_cross_sections</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
        <span class="n">chi_bf</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_i</span> <span class="o">-</span> <span class="n">lte_n_i</span> <span class="o">*</span> <span class="n">boltzmann_factor_photo_ion</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span>
            <span class="n">x_sect</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>

        <span class="n">num_neg_elements</span> <span class="o">=</span> <span class="p">(</span><span class="n">chi_bf</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">num_neg_elements</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PlasmaException</span><span class="p">(</span><span class="s2">&quot;Negative values in bound-free opacity.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">chi_bf</span></div></div>


<div class="viewcode-block" id="LevelNumberDensityLTE"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.LevelNumberDensityLTE">[docs]</a><span class="k">class</span> <span class="nc">LevelNumberDensityLTE</span><span class="p">(</span><span class="n">ProcessingPlasmaProperty</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    lte_level_number_density : pandas.DataFrame, dtype float</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;lte_level_number_density&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;n_{\textrm</span><span class="si">{i}</span><span class="s2">}^*&quot;</span><span class="p">,)</span>

    <span class="c1"># TODO: only do this for continuum species</span>
<div class="viewcode-block" id="LevelNumberDensityLTE.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.LevelNumberDensityLTE.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">electron_densities</span><span class="p">,</span> <span class="n">phi_ik</span><span class="p">,</span> <span class="n">ion_number_density</span><span class="p">):</span>
        <span class="n">next_higher_ion_index</span> <span class="o">=</span> <span class="n">get_ion_multi_index</span><span class="p">(</span>
            <span class="n">phi_ik</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">next_higher</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="c1"># TODO: Check that n_k is correct (and not n_k*)</span>
        <span class="n">lte_level_number_density</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">phi_ik</span> <span class="o">*</span> <span class="n">ion_number_density</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">next_higher_ion_index</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">electron_densities</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lte_level_number_density</span></div></div>


<div class="viewcode-block" id="PhotoIonBoltzmannFactor"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.PhotoIonBoltzmannFactor">[docs]</a><span class="k">class</span> <span class="nc">PhotoIonBoltzmannFactor</span><span class="p">(</span><span class="n">ProcessingPlasmaProperty</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    boltzmann_factor_photo_ion : pandas.DataFrame, dtype float</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;boltzmann_factor_photo_ion&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="PhotoIonBoltzmannFactor.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.PhotoIonBoltzmannFactor.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">photo_ion_cross_sections</span><span class="p">,</span> <span class="n">t_electrons</span><span class="p">):</span>
        <span class="n">nu</span> <span class="o">=</span> <span class="n">photo_ion_cross_sections</span><span class="p">[</span><span class="s2">&quot;nu&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="n">boltzmann_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">nu</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">t_electrons</span> <span class="o">*</span> <span class="p">(</span><span class="n">H</span> <span class="o">/</span> <span class="n">K_B</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">boltzmann_factor</span></div></div>


<div class="viewcode-block" id="CollIonRateCoeffSeaton"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.CollIonRateCoeffSeaton">[docs]</a><span class="k">class</span> <span class="nc">CollIonRateCoeffSeaton</span><span class="p">(</span><span class="n">ProcessingPlasmaProperty</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    coll_ion_coeff : pandas.DataFrame, dtype float</span>
<span class="sd">        The rate coefficient for collisional ionization in the Seaton</span>
<span class="sd">        approximation. Multiply with the electron density and the</span>
<span class="sd">        level number density to obtain the total rate.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The rate coefficient for collisional ionization in the Seaton approximation</span>
<span class="sd">    is calculated according to Eq. 9.60 in [1].</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Hubeny, I. and Mihalas, D., &quot;Theory of Stellar Atmospheres&quot;. 2014.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;coll_ion_coeff&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;c_{\textrm{i,}\kappa}&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="CollIonRateCoeffSeaton.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.CollIonRateCoeffSeaton.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">photo_ion_cross_sections</span><span class="p">,</span> <span class="n">t_electrons</span><span class="p">):</span>
        <span class="n">photo_ion_cross_sections_threshold</span> <span class="o">=</span> <span class="n">photo_ion_cross_sections</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
            <span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
        <span class="n">nu_i</span> <span class="o">=</span> <span class="n">photo_ion_cross_sections_threshold</span><span class="p">[</span><span class="s2">&quot;nu&quot;</span><span class="p">]</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_factor</span><span class="p">(</span><span class="n">nu_i</span><span class="p">,</span> <span class="n">t_electrons</span><span class="p">)</span>
        <span class="n">coll_ion_coeff</span> <span class="o">=</span> <span class="mf">1.55e13</span> <span class="o">*</span> <span class="n">photo_ion_cross_sections_threshold</span><span class="p">[</span><span class="s2">&quot;x_sect&quot;</span><span class="p">]</span>
        <span class="n">coll_ion_coeff</span> <span class="o">=</span> <span class="n">factor</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">coll_ion_coeff</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">coll_ion_coeff</span> <span class="o">=</span> <span class="n">coll_ion_coeff</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t_electrons</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">ion_number</span> <span class="o">=</span> <span class="n">coll_ion_coeff</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;ion_number&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
        <span class="n">coll_ion_coeff</span><span class="p">[</span><span class="n">ion_number</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">0.1</span>
        <span class="n">coll_ion_coeff</span><span class="p">[</span><span class="n">ion_number</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">0.2</span>
        <span class="n">coll_ion_coeff</span><span class="p">[</span><span class="n">ion_number</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">0.3</span>
        <span class="k">return</span> <span class="n">coll_ion_coeff</span></div>

    <span class="k">def</span> <span class="nf">_calculate_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nu_i</span><span class="p">,</span> <span class="n">t_electrons</span><span class="p">):</span>
        <span class="n">u0s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_u0s</span><span class="p">(</span><span class="n">nu_i</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">t_electrons</span><span class="p">)</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">u0s</span><span class="p">)</span> <span class="o">/</span> <span class="n">u0s</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">nu_i</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">factor</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_calculate_u0s</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">t_electrons</span><span class="p">):</span>
        <span class="n">u0s</span> <span class="o">=</span> <span class="n">nu</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">t_electrons</span> <span class="o">*</span> <span class="p">(</span><span class="n">H</span> <span class="o">/</span> <span class="n">K_B</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">u0s</span></div>


<div class="viewcode-block" id="CollRecombRateCoeff"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.CollRecombRateCoeff">[docs]</a><span class="k">class</span> <span class="nc">CollRecombRateCoeff</span><span class="p">(</span><span class="n">ProcessingPlasmaProperty</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    coll_recomb_coeff : pandas.DataFrame, dtype float</span>
<span class="sd">        The rate coefficient for collisional recombination.</span>
<span class="sd">        Multiply with the electron density squared and the ion number density</span>
<span class="sd">        to obtain the total rate.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The collisional recombination rate coefficient is calculated from the</span>
<span class="sd">    collisional ionization rate coefficient based on the requirement of detailed</span>
<span class="sd">    balance.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;coll_recomb_coeff&quot;</span><span class="p">,)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;c_{\kappa\textrm{i,}}&quot;</span><span class="p">,)</span>

<div class="viewcode-block" id="CollRecombRateCoeff.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.CollRecombRateCoeff.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phi_ik</span><span class="p">,</span> <span class="n">coll_ion_coeff</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">coll_ion_coeff</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">phi_ik</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">coll_ion_coeff</span><span class="o">.</span><span class="n">index</span><span class="p">])</span></div></div>


<div class="viewcode-block" id="RawCollIonTransProbs"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.RawCollIonTransProbs">[docs]</a><span class="k">class</span> <span class="nc">RawCollIonTransProbs</span><span class="p">(</span><span class="n">TransitionProbabilitiesProperty</span><span class="p">,</span> <span class="n">IndexSetterMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    p_coll_ion : pandas.DataFrame, dtype float</span>
<span class="sd">        The unnormalized transition probabilities for</span>
<span class="sd">        collisional ionization.</span>
<span class="sd">    p_coll_recomb : pandas.DataFrame, dtype float</span>
<span class="sd">        The unnormalized transition probabilities for</span>
<span class="sd">        collisional recombination.</span>
<span class="sd">    cool_rate_coll_ion : pandas.DataFrame, dtype float</span>
<span class="sd">        The collisional ionization cooling rates of the electron gas.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;p_coll_ion&quot;</span><span class="p">,</span> <span class="s2">&quot;p_coll_recomb&quot;</span><span class="p">,</span> <span class="s2">&quot;cool_rate_coll_ion&quot;</span><span class="p">)</span>
    <span class="n">transition_probabilities_outputs</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;p_coll_ion&quot;</span><span class="p">,</span>
        <span class="s2">&quot;p_coll_recomb&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cool_rate_coll_ion&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">latex_name</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;p^{\textrm{coll ion}}&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;p^{\textrm{coll recomb}}&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;C^{\textrm</span><span class="si">{ion}</span><span class="s2">}&quot;</span><span class="p">,</span>
    <span class="p">)</span>

<div class="viewcode-block" id="RawCollIonTransProbs.calculate"><a class="viewcode-back" href="../../../../api/tardis.plasma.properties.continuum_processes.html#tardis.plasma.properties.continuum_processes.RawCollIonTransProbs.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">coll_ion_coeff</span><span class="p">,</span>
        <span class="n">coll_recomb_coeff</span><span class="p">,</span>
        <span class="n">nu_i</span><span class="p">,</span>
        <span class="n">photo_ion_idx</span><span class="p">,</span>
        <span class="n">electron_densities</span><span class="p">,</span>
        <span class="n">energy_i</span><span class="p">,</span>
        <span class="n">level_number_density</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">p_coll_ion</span> <span class="o">=</span> <span class="n">coll_ion_coeff</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">energy_i</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">p_coll_ion</span> <span class="o">=</span> <span class="n">p_coll_ion</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">electron_densities</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">p_coll_ion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">p_coll_ion</span><span class="p">,</span> <span class="n">photo_ion_idx</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">coll_recomb_rate</span> <span class="o">=</span> <span class="n">coll_recomb_coeff</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span>
            <span class="n">electron_densities</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>  <span class="c1"># The full rate is obtained from this by multiplying by the</span>
        <span class="c1"># electron density and ion number density.</span>
        <span class="n">p_recomb_deactivation</span> <span class="o">=</span> <span class="n">coll_recomb_rate</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">nu_i</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">H</span>
        <span class="n">p_recomb_deactivation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
            <span class="n">p_recomb_deactivation</span><span class="p">,</span> <span class="n">photo_ion_idx</span><span class="p">,</span> <span class="n">transition_type</span><span class="o">=-</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="n">p_recomb_deactivation</span> <span class="o">=</span> <span class="n">p_recomb_deactivation</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">index_dd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">(</span>
            <span class="p">[</span><span class="n">p_recomb_deactivation</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">photo_ion_idx</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;transition_type&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">p_recomb_deactivation</span> <span class="o">=</span> <span class="n">p_recomb_deactivation</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">index_dd</span><span class="p">)</span>

        <span class="n">p_recomb_internal</span> <span class="o">=</span> <span class="n">coll_recomb_rate</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">energy_i</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">p_recomb_internal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
            <span class="n">p_recomb_internal</span><span class="p">,</span> <span class="n">photo_ion_idx</span><span class="p">,</span> <span class="n">transition_type</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>
        <span class="n">p_coll_recomb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">p_recomb_deactivation</span><span class="p">,</span> <span class="n">p_recomb_internal</span><span class="p">])</span>

        <span class="n">cool_rate_coll_ion</span> <span class="o">=</span> <span class="p">(</span><span class="n">coll_ion_coeff</span> <span class="o">*</span> <span class="n">electron_densities</span><span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span>
            <span class="n">nu_i</span> <span class="o">*</span> <span class="n">H</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>
        <span class="n">level_lower_index</span> <span class="o">=</span> <span class="n">coll_ion_coeff</span><span class="o">.</span><span class="n">index</span>
        <span class="n">cool_rate_coll_ion</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">cool_rate_coll_ion</span>
            <span class="o">*</span> <span class="n">level_number_density</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">level_lower_index</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="p">)</span>
        <span class="n">cool_rate_coll_ion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
            <span class="n">cool_rate_coll_ion</span><span class="p">,</span> <span class="n">photo_ion_idx</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="n">cool_rate_coll_ion</span> <span class="o">=</span> <span class="n">cool_rate_coll_ion</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
            <span class="n">level</span><span class="o">=</span><span class="s2">&quot;destination_level_idx&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">ion_cool_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">(</span>
            <span class="p">[[</span><span class="s2">&quot;k&quot;</span><span class="p">],</span> <span class="n">cool_rate_coll_ion</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">photo_ion_idx</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;transition_type&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">cool_rate_coll_ion</span> <span class="o">=</span> <span class="n">cool_rate_coll_ion</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">ion_cool_index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p_coll_ion</span><span class="p">,</span> <span class="n">p_coll_recomb</span><span class="p">,</span> <span class="n">cool_rate_coll_ion</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2013-2021, TARDIS Collaboration.
      <span class="lastupdated">
        Last updated on 12 Jul 2021.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>